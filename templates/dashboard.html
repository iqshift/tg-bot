<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ø¨ÙˆØª Ø§Ù„Ù…Ø­Ù…ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ</title>
    <!-- Ø®Ø· Cairo Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø­Ø¯ÙŠØ« -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <!-- Font Awesome Ù„Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ù‚ØªØ±Ø­ */
            --primary: #3B82F6;
            --primary-light: #60A5FA;
            --primary-dark: #2563EB;
            --secondary: #0EA5E9;
            --bg-body: #0B1220;
            --bg-sidebar: #0F172A;
            --bg-card: #111827;
            --bg-card-hover: #1E293B;
            --border: #1E293B;
            --text-main: #F8FAFC;
            --text-muted: #94A3B8;
            --success: #10B981;
            --error: #EF4444;
            --warning: #F59E0B;
            --glass: rgba(17, 24, 39, 0.7);

            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --sidebar-width: 280px;
            --sidebar-collapsed-width: 80px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Ø§Ù„Ù…Ø¸Ù‡Ø± Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠ */
        .glass {
            background: var(--glass);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border);
        }

        /* Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¹Ø§Ù… */
        .wrapper {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--bg-sidebar);
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            right: 0;
            top: 0;
            z-index: 100;
            transition: var(--transition);
        }

        .sidebar-header {
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--border);
        }

        .sidebar-header .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .sidebar-header h1 {
            font-size: 18px;
            font-weight: 700;
            white-space: nowrap;
        }

        .sidebar-menu {
            flex: 1;
            padding: 20px 12px;
            overflow-y: auto;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            color: var(--text-muted);
            text-decoration: none;
            margin-bottom: 4px;
            transition: var(--transition);
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: right;
            font-family: inherit;
            font-size: 15px;
        }

        .menu-item i {
            width: 20px;
            font-size: 18px;
        }

        .menu-item:hover {
            background-color: rgba(59, 130, 246, 0.1);
            color: var(--primary-light);
            padding-right: 20px;
        }

        .menu-item.active {
            background: linear-gradient(to left, rgba(59, 130, 246, 0.2), transparent);
            color: var(--primary);
            font-weight: 600;
            position: relative;
        }

        .menu-item.active::after {
            content: '';
            position: absolute;
            right: 0;
            top: 15%;
            height: 70%;
            width: 4px;
            background-color: var(--primary);
            border-radius: 4px 0 0 4px;
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px;
            border-radius: 12px;
            background: rgba(30, 41, 59, 0.5);
        }

        .user-profile img {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            object-fit: cover;
        }

        .user-info .name {
            font-size: 14px;
            font-weight: 600;
            display: block;
        }

        .user-info .role {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-container {
            flex: 1;
            margin-right: var(--sidebar-width);
            transition: var(--transition);
            padding: 24px;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .page-title h2 {
            font-size: 24px;
            font-weight: 800;
        }

        .page-title .breadcrumb {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 14px;
            border-radius: 30px;
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            font-size: 13px;
            font-weight: 600;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success);
            box-shadow: 0 0 8px var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.5);
                opacity: 0.5;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            padding: 24px;
            border-radius: 20px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            margin-bottom: 16px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            display: block;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .growth {
            font-size: 12px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .growth.up {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .growth.down {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ§Ù„Ø´Ø¨ÙƒØ§Øª */
        .card {
            padding: 24px;
            border-radius: 20px;
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
        }

        /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØ§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            text-align: right;
        }

        th {
            padding: 14px 16px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border);
        }

        td {
            padding: 16px;
            font-size: 14px;
            border-bottom: 1px solid var(--border);
        }

        tr:hover td {
            background-color: rgba(255, 255, 255, 0.02);
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-family: inherit;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            transform: scale(1.02);
        }

        .btn-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .btn-danger:hover {
            background: var(--error);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-muted);
        }

        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ (Forms) */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-muted);
        }

        input[type="text"],
        textarea {
            width: 100%;
            background-color: rgba(15, 23, 42, 0.5);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px 16px;
            color: var(--text-main);
            font-family: inherit;
            transition: var(--transition);
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            background-color: rgba(15, 23, 42, 0.8);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        textarea {
            resize: vertical;
        }

        /* Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª (Flash Messages) */
        #flash-container {
            position: fixed;
            top: 24px;
            left: 24px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .toast {
            padding: 16px 24px;
            border-radius: 12px;
            background: var(--bg-card);
            border-right: 4px solid var(--primary);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.success {
            border-right-color: var(--success);
        }

        .toast.error {
            border-right-color: var(--error);
        }

        /* Ø®Ø§ØµÙŠØ© Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† */
        .user-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .user-card {
            padding: 16px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            text-decoration: none;
            color: inherit;
            transition: var(--transition);
        }

        .user-card:hover {
            background-color: var(--bg-card-hover);
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .user-avatar {
            width: 54px;
            height: 54px;
            border-radius: 14px;
            background: linear-gradient(135deg, var(--bg-sidebar), var(--bg-body));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-details {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            display: block;
            font-weight: 700;
            font-size: 15px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-handle {
            display: block;
            font-size: 13px;
            color: var(--text-muted);
        }

        .user-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .user-status-dot.active {
            background-color: var(--success);
        }

        .user-status-dot.banned {
            background-color: var(--error);
        }

        /* Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† - Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© */
        .user-card {
            position: relative;
        }

        .user-actions-dropdown {
            position: absolute;
            left: 10px;
            top: 10px;
            z-index: 5;
        }

        .dots-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dots-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--primary);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            left: 0;
            top: 40px;
            background-color: var(--bg-sidebar);
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow: hidden;
            z-index: 20;
        }

        .dropdown-content.show {
            display: block;
            animation: dropdownFade 0.2s ease-out;
        }

        @keyframes dropdownFade {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-item {
            color: var(--text-main);
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            transition: var(--transition);
            background: none;
            border: none;
            width: 100%;
            text-align: right;
            cursor: pointer;
            font-family: inherit;
        }

        .dropdown-item:hover {
            background-color: var(--bg-card-hover);
            color: var(--primary);
        }

        .dropdown-item i {
            width: 16px;
            font-size: 14px;
        }

        /* Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 1024px) {
            .sidebar {
                width: var(--sidebar-collapsed-width);
            }

            .sidebar-header h1,
            .sidebar-header .logo-text,
            .menu-item span,
            .user-info {
                display: none;
            }

            .main-container {
                margin-right: var(--sidebar-collapsed-width);
            }

            .menu-item {
                justify-content: center;
                padding: 12px;
            }

            .menu-item i {
                margin: 0;
                font-size: 20px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
                width: var(--sidebar-width);
            }

            .sidebar.mobile-open .menu-item span {
                display: inline;
            }

            .main-container {
                margin-right: 0;
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>

<body>

    <!-- Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª -->
    <div id="flash-container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="toast {{ category }}">
            <i
                class="fa-solid {% if category == 'success' %}fa-circle-check{% else %}fa-circle-exclamation{% endif %}"></i>
            <span>{{ message }}</span>
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
    </div>

    <div class="wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-icon">
                    <i class="fa-solid fa-bolt"></i>
                </div>
                <div class="logo-text">
                    <h1>Ø¨ÙˆØª Ø§Ù„ØªØ­Ù…ÙŠÙ„</h1>
                </div>
            </div>

            <nav class="sidebar-menu">
                <button class="menu-item active" onclick="showSection('overview', this)">
                    <i class="fa-solid fa-house"></i>
                    <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
                </button>
                <button class="menu-item" onclick="showSection('users', this)">
                    <i class="fa-solid fa-users"></i>
                    <span>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                </button>
                <button class="menu-item" onclick="showSection('settings', this)">
                    <i class="fa-solid fa-sliders"></i>
                    <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</span>
                </button>
                <button class="menu-item" onclick="showSection('connection-settings', this)">
                    <i class="fa-solid fa-key"></i>
                    <span>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø¨Ø·</span>
                </button>
                <button class="menu-item" onclick="showSection('channels', this)">
                    <i class="fa-solid fa-bullhorn"></i>
                    <span>Ø§Ù„Ù‚Ù†ÙˆØ§Øª</span>
                </button>
                <button class="menu-item" onclick="showSection('errors-section', this)" id="nav-errors">
                    <i class="fa-solid fa-bug"></i>
                    <span>Ø³Ø¬Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</span>
                </button>
                <button class="menu-item" onclick="showSection('proxies-section', this)">
                    <i class="fa-solid fa-shield-halved"></i>
                    <span>Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª</span>
                </button>
                <button class="menu-item" onclick="showSection('whitelist-section', this)">
                    <i class="fa-solid fa-star"></i>
                    <span>Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡</span>
                </button>
                <button class="menu-item" onclick="showSection('server-specs-section', this)">
                    <i class="fa-solid fa-server"></i>
                    <span>Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø®Ø§Ø¯Ù…</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <div class="user-profile">
                    <img src="https://api.dicebear.com/6.x/bottts/svg?seed=Admin" alt="Admin">
                    <div class="user-info">
                        <span class="name">Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</span>
                        <span class="role">Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-container">
            <header class="page-header">
                <div class="page-title">
                    <h2 id="pageTitleDisplay">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                    <div class="breadcrumb">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© / Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
                </div>
                <div class="header-actions">
                    <div class="status-badge">
                        <div class="status-dot"></div>
                        <span>Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„</span>
                    </div>
                    <button class="btn btn-outline" onclick="location.reload()">
                        <i class="fa-solid fa-rotate"></i>
                    </button>
                </div>
            </header>

            <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div class="stats-grid">
                <div class="stat-card glass">
                    <div class="stat-icon" style="background: rgba(59, 130, 246, 0.1); color: var(--primary);">
                        <i class="fa-solid fa-users"></i>
                    </div>
                    <span class="stat-value">{{ stats.total_users }}</span>
                    <span class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† <span class="growth up">Ù†Ø´Ø·</span></span>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon" style="background: rgba(239, 68, 68, 0.1); color: var(--error);">
                        <i class="fa-solid fa-user-slash"></i>
                    </div>
                    <span class="stat-value">{{ stats.banned_users }}</span>
                    <span class="stat-label">Ù…Ø­Ø¸ÙˆØ±ÙŠÙ† <span class="growth down">Ù…Ø·Ø±ÙˆØ¯</span></span>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10B981;">
                        <i class="fa-solid fa-star"></i>
                    </div>
                    <span class="stat-value">{{ stats.whitelist_count or 0 }}</span>
                    <span class="stat-label">Ø§Ù„Ù…Ù…ÙŠØ²ÙŠÙ† (VIP) <span class="growth up">Ù…Ø¹ÙÙŠ</span></span>
                </div>
                <div class="stat-card glass"
                    onclick="showSection('errors-section', document.getElementById('nav-errors'))"
                    style="cursor: pointer;">
                    <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: var(--warning);">
                        <i class="fa-solid fa-triangle-exclamation"></i>
                    </div>
                    <span class="stat-value" id="stats-errors-count">{{ stats.total_errors }}</span>
                    <span class="stat-label">Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø±Ù…Ø¬ÙŠØ© <span class="growth down">Ø­Ø±Ø¬Ø©</span></span>
                </div>
            </div>

            <div class="content-body">

                <!-- Overview: Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ -->
                <div id="overview" class="section active">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fa-solid fa-paper-plane"
                                    style="margin-left: 8px;"></i>Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ù…Ø§Ø¹ÙŠØ© (Broadcast)</h3>
                        </div>
                        <form action="/broadcast" method="POST" id="broadcast-form">
                            <div class="form-group">
                                <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                                <input type="text" name="title" placeholder="Ù…Ø«Ù„Ø§Ù‹: ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¨ÙˆØª">
                            </div>
                            <div class="form-group">
                                <label>Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
                                <textarea name="message" rows="5" placeholder="Ø§ÙƒØªØ¨ Ù…Ø§ ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„Ù‡ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†..."
                                    required></textarea>
                            </div>
                            <div style="display: flex; justify-content: flex-end;">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fa-solid fa-share-all"></i>
                                    Ø¨Ø¯Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¬Ù…ÙŠØ¹
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Users Section -->
                <div id="users" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                            <div class="header-actions">
                                <input type="text" id="user-search" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…..."
                                    style="margin: 0; width: 200px; padding: 6px 12px;">
                            </div>
                        </div>
                        <div class="user-grid">
                            {% for user in users %}
                            <div class="user-card-wrapper" style="position: relative;">
                                <a href="/chat/{{ user.user_id }}" target="_blank" class="user-card glass">
                                    <div class="user-avatar">
                                        {% if user.photo_file_id %}
                                        <img src="/api/user_photo/{{ user.photo_file_id }}" alt="{{ user.first_name }}"
                                            onerror="this.src='{{ user.photo_url }}';">
                                        {% elif user.photo_url %}
                                        <img src="{{ user.photo_url }}" alt="{{ user.first_name }}"
                                            onerror="this.parentNode.innerText='{{ user.first_name[0] }}';">
                                        {% else %}
                                        {{ user.first_name[0] if user.first_name else 'ØŸ' }}
                                        {% endif %}
                                    </div>
                                    <div class="user-details">
                                        <span class="user-name">{{ user.first_name }}</span>
                                        <span class="user-handle">@{{ user.username if user.username else user.user_id
                                            }}</span>
                                    </div>
                                    <div
                                        class="user-status-dot {% if user.is_banned %}banned{% else %}active{% endif %}">
                                    </div>
                                </a>

                                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
                                <div class="user-actions-dropdown">
                                    <button class="dots-btn"
                                        onclick="toggleUserDropdown(event, 'dropdown-{{ user.user_id }}')">
                                        <i class="fa-solid fa-ellipsis-vertical"></i>
                                    </button>
                                    <div id="dropdown-{{ user.user_id }}" class="dropdown-content">
                                        <form action="/ban_user/{{ user.user_id }}" method="POST">
                                            {% if user.is_banned %}
                                            <button type="submit" class="dropdown-item"
                                                formaction="/unban_user/{{ user.user_id }}">
                                                <i class="fa-solid fa-user-check" style="color: var(--success);"></i>
                                                <span>Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¸Ø±</span>
                                            </button>
                                            {% else %}
                                            <button type="submit" class="dropdown-item" style="color: var(--error);">
                                                <i class="fa-solid fa-user-slash"></i>
                                                <span>Ø­Ø¸Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</span>
                                            </button>
                                            {% endif %}
                                        </form>
                                        <form action="/whitelist/add" method="POST">
                                            <input type="hidden" name="user_id" value="{{ user.user_id }}">
                                            <button type="submit" class="dropdown-item">
                                                <i class="fa-solid fa-star" style="color: var(--warning);"></i>
                                                <span>Ø¥Ø¶Ø§ÙØ© VIP</span>
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Connection Settings Section -->
                <div id="connection-settings" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„ØªÙˆÙƒÙ† ğŸ”‘</h3>
                        </div>
                        <div style="padding: 20px;">
                            <form onsubmit="saveConnectionSettings(event)">
                                <div class="stats-grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
                                    <div class="form-group">
                                        <label>ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª (Telegram Token)</label>
                                        <input type="password" id="field_telegram_token"
                                            value="{{ settings.telegram_token }}" placeholder="123456789:ABCDEF..."
                                            style="width: 100%;">
                                        <small style="color: var(--text-muted); font-size: 11px;">Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø­Ø§Ù„
                                            Ø¹Ø¯Ù… ØªÙˆÙØ± Ø§Ù„ØªÙˆÙƒÙ† ÙÙŠ Ù…Ù„ÙØ§Øª Ø§Ù„Ø³ÙŠØ±ÙØ±.</small>
                                    </div>
                                    <div class="form-group">
                                        <label>Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨-Ù‡ÙˆÙƒ (Webhook URL)</label>
                                        <input type="url" id="field_webhook_url" value="{{ settings.webhook_url }}"
                                            placeholder="https://your-app.run.app" style="width: 100%;">
                                        <small style="color: var(--text-muted); font-size: 11px;">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ø³ÙŠØ±ÙØ±
                                            (Ù…Ø«Ù„ Ø±Ø§Ø¨Ø· Cloud Run).</small>
                                    </div>
                                </div>
                                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px;">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fa-solid fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                                    </button>
                                    <button type="button" class="btn btn-outline" onclick="activateWebhook(event)"
                                        style="border-color: var(--primary); color: var(--primary);">
                                        <i class="fa-solid fa-bolt"></i> ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆÙŠØ¨-Ù‡ÙˆÙƒ ÙÙˆØ±Ø§Ù‹
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settings" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„</h3>
                        </div>
                        <form action="/update_settings" method="POST">
                            <div class="stats-grid" style="grid-template-columns: 1fr 1fr;">
                                <div class="form-group">
                                    <label>Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ (/start)</label>
                                    <textarea name="welcome_msg" rows="3">{{ settings.welcome_msg }}</textarea>
                                </div>
                                <div class="form-group">
                                    <label>Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© (/help)</label>
                                    <textarea name="help_msg" rows="3">{{ settings.help_msg }}</textarea>
                                </div>
                            </div>
                            <div class="stats-grid" style="grid-template-columns: 1fr 1fr;">
                                <div class="form-group">
                                    <label>Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙŠ ÙŠØ±Ø³Ù„Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø£ØµØ¯Ù‚Ø§Ø¦Ù‡)</label>
                                    <textarea name="share_msg" rows="3">{{ settings.share_msg }}</textarea>
                                </div>
                                <div class="form-group">
                                    <label>Ù†Øµ Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</label>
                                    <input type="text" name="share_btn_text" value="{{ settings.share_btn_text }}">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ</label>
                                <textarea name="msg_force_sub" rows="3">{{ settings.msg_force_sub }}</textarea>
                                <small style="color: var(--text-muted);">Ø§Ø³ØªØ®Ø¯Ù… {channels} Ù„ÙˆØ¶Ø¹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª
                                    ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</small>
                            </div>
                            <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div class="form-group">
                                    <label>ØªØ°ÙŠÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Caption)</label>
                                    <input type="text" name="msg_caption" value="{{ settings.msg_caption }}">
                                </div>
                            </div>
                            <div style="display: flex; justify-content: flex-end;">
                                <button class="btn btn-primary">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Channels Section -->
                <div id="channels" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title">Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h3>
                        </div>
                        <form action="/add_channel" method="POST"
                            style="background: rgba(15, 23, 42, 0.4); padding: 20px; border-radius: 16px; margin-bottom: 24px;">
                            <label>Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø© Ø¬Ø¯ÙŠØ¯Ø©</label>
                            <div style="display: flex; gap: 12px;">
                                <input type="text" name="channel_name" placeholder="@channel_username"
                                    style="margin: 0;">
                                <button class="btn btn-primary">Ø¥Ø¶Ø§ÙØ©</button>
                            </div>
                        </form>

                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©</th>
                                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        <th style="width: 100px;">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for channel in channels_list %}
                                    <tr>
                                        <td><span style="color: var(--primary); font-weight: 700;">{{ channel }}</span>
                                        </td>
                                        <td><span class="status-badge"
                                                style="background: rgba(16, 185, 129, 0.05); width: fit-content; padding: 4px 12px;">Ù†Ø´Ø·Ø©</span>
                                        </td>
                                        <td>
                                            <form action="/delete_channel" method="POST" style="margin: 0;">
                                                <input type="hidden" name="channel_name" value="{{ channel }}">
                                                <button class="btn btn-danger"
                                                    style="padding: 6px 12px; font-size: 12px;">Ø­Ø°Ù</button>
                                            </form>
                                        </td>
                                    </tr>
                                    {% else %}
                                    <tr>
                                        <td colspan="3"
                                            style="text-align: center; color: var(--text-muted); padding: 40px;">Ù„Ø§ ØªÙˆØ¬Ø¯
                                            Ù‚Ù†ÙˆØ§Øª Ù…ÙØ¹Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Error Logs Section -->
                <div id="errors-section" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title">Ø³Ø¬Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªÙ‚Ù†ÙŠØ©</h3>
                            <form action="/errors/clear" method="POST" style="margin:0;">
                                <button class="btn btn-danger" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')">
                                    <i class="fa-solid fa-trash-can"></i> Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„
                                </button>
                            </form>
                        </div>
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Ø§Ù„ØªÙˆÙ‚ÙŠØª</th>
                                        <th>Ø§Ù„Ù…Ù†ØµØ©</th>
                                        <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                        <th>Ø§Ù„Ø®Ø·Ø£</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for err in errors %}
                                    <tr>
                                        <td style="color: var(--text-muted); font-size: 13px;">{{ err.timestamp }}</td>
                                        <td><span
                                                style="background: rgba(59, 130, 246, 0.1); padding: 4px 10px; border-radius: 8px;">{{
                                                err.platform }}</span></td>
                                        <td>{{ err.user_id or 'Ù†Ø¸Ø§Ù…' }}</td>
                                        <td>
                                            <details>
                                                <summary style="cursor: pointer; color: var(--error);">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø®Ø·Ø£
                                                </summary>
                                                <pre
                                                    style="margin-top: 10px; background: #000; padding: 12px; border-radius: 8px; font-size: 12px; color: #ff8a80; overflow-x: auto;">{{ err.error_msg }}</pre>
                                            </details>
                                        </td>
                                    </tr>
                                    {% else %}
                                    <tr>
                                        <td colspan="4"
                                            style="text-align: center; color: var(--success); padding: 40px;">âœ… Ù„Ø§ ØªÙˆØ¬Ø¯
                                            Ø£Ø®Ø·Ø§Ø¡ Ø­Ø§Ù„ÙŠØ§Ù‹</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Proxies Section -->
                <div id="proxies-section" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title">Ø¥Ø¯Ø§Ø±Ø© ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª</h3>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-outline" onclick="checkCurrentProxies()" id="btn-check-current">
                                    <i class="fa-solid fa-magnifying-glass"></i> ÙØ­Øµ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                                </button>
                                <button class="btn btn-danger" onclick="clearAllProxies()">
                                    <i class="fa-solid fa-broom"></i> Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                                </button>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                            <div>
                                <label>Ø¥Ø¶Ø§ÙØ© Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø© (Line by Line)</label>
                                <textarea id="new-proxies-input" rows="8"
                                    placeholder="socks5://user:pass@host:port&#10;http://host:port"></textarea>
                                <button class="btn btn-primary" onclick="addAndCheckProxies()" id="btn-add-check"
                                    style="width: 100%; margin-top: 12px;">
                                    <i class="fa-solid fa-plus"></i> Ø¥Ø¶Ø§ÙØ© ÙˆÙØ­Øµ Ø§Ù„Ø´Ø§ØºÙ„
                                </button>
                            </div>
                            <div
                                style="background: rgba(15, 23, 42, 0.4); border-radius: 20px; padding: 20px; border: 1px solid var(--border);">
                                <label>Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (<span id="proxies-count-badge">0</span>)</label>
                                <div id="proxy-current-list"
                                    style="max-height: 250px; overflow-y: auto; font-family: monospace; font-size: 13px; color: var(--primary-light);">
                                    Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
                                </div>
                            </div>
                        </div>
                        <div id="proxy-result-box" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <!-- Whitelist Section -->
                <div id="whitelist-section" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title">ğŸŒŸ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ (Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø¹ÙÙŠÙŠÙ†)</h3>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                            <div style="background: rgba(15, 23, 42, 0.4); padding: 20px; border-radius: 20px;">
                                <label>Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</label>
                                <form action="/whitelist/add" method="POST">
                                    <div class="form-group">
                                        <input type="text" name="user_id" placeholder="Telegram User ID (e.g. 1234567)">
                                    </div>
                                    <div class="form-group">
                                        <label>Ø±Ø¯ Ù…Ø®ØµØµ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                                        <input type="text" name="custom_reply"
                                            placeholder="Ø§Ù„Ø±Ø¯ Ø§Ù„Ø°ÙŠ ÙŠØ¸Ù‡Ø± Ù„Ù‡ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù„ÙŠÙ„">
                                        <small style="color: var(--text-muted);">Ø¥Ø°Ø§ ØªÙØ±ÙÙƒ ÙØ§Ø±ØºØ§Ù‹ Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„Ø±Ø¯
                                            Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ.</small>
                                    </div>
                                    <button class="btn btn-primary" style="width: 100%;">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
                                </form>
                            </div>

                            <div style="background: rgba(15, 23, 42, 0.4); border-radius: 20px; padding: 20px;">
                                <label>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†</label>
                                <div style="max-height: 300px; overflow-y: auto;">
                                    <table style="width: 100%;">
                                        <thead>
                                            <tr>
                                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                                <th>Ø§Ù„Ø±Ø¯ Ø§Ù„Ø®Ø§Øµ</th>
                                                <th>Ø­Ø°Ù</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for w in whitelist %}
                                            <tr>
                                                <td><span style="color: var(--primary); font-weight: 700;">{{ w.user_id
                                                        }}</span></td>
                                                <td style="font-size: 12px; color: var(--text-muted);">{{ w.custom_reply
                                                    or 'Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ' }}</td>
                                                <td>
                                                    <form action="/whitelist/delete" method="POST" style="margin: 0;">
                                                        <input type="hidden" name="user_id" value="{{ w.user_id }}">
                                                        <button class="btn btn-danger"
                                                            style="padding: 4px 8px; font-size: 11px;">Ã—</button>
                                                    </form>
                                                </td>
                                            </tr>
                                            {% else %}
                                            <tr>
                                                <td colspan="3"
                                                    style="text-align: center; color: var(--text-muted); padding: 20px;">
                                                    Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù…ÙŠØ²ÙŠÙ†</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Server Specs Section -->
                <div id="server-specs-section" class="section">
                    <div class="card glass">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fa-solid fa-microchip"
                                    style="margin-left: 8px;"></i>Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ©</h3>
                            <button class="btn btn-outline" onclick="fetchServerSpecs()">
                                <i class="fa-solid fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                            </button>
                        </div>

                        <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                            <!-- RAM Card -->
                            <div class="stat-card glass" style="background: rgba(30, 41, 59, 0.3);">
                                <div class="stat-icon"
                                    style="background: rgba(59, 130, 246, 0.1); color: var(--primary);">
                                    <i class="fa-solid fa-memory"></i>
                                </div>
                                <span class="stat-value" id="spec-ram">...</span>
                                <span class="stat-label">Ø°Ø§ÙƒØ±Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ (RAM)</span>
                            </div>

                            <!-- Storage Card -->
                            <div class="stat-card glass" style="background: rgba(30, 41, 59, 0.3);">
                                <div class="stat-icon"
                                    style="background: rgba(16, 185, 129, 0.1); color: var(--success);">
                                    <i class="fa-solid fa-hard-drive"></i>
                                </div>
                                <span class="stat-value" id="spec-storage">...</span>
                                <span class="stat-label">Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙ‡Ù„ÙƒØ© (Disk)</span>
                            </div>
                        </div>

                        <!-- Internet Speed Section -->
                        <div class="card glass" style="margin-top: 24px; background: rgba(15, 23, 42, 0.2);">
                            <div class="card-header">
                                <h4 class="card-title"><i class="fa-solid fa-gauge-high"
                                        style="margin-left: 8px;"></i>Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª (Speed Test)</h4>
                                <button class="btn btn-primary" id="btn-speedtest" onclick="runSpeedTest()">
                                    <i class="fa-solid fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢Ù†ÙŠ
                                </button>
                            </div>

                            <div id="speedtest-results"
                                style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; display: none;">
                                <div class="stat-card glass" style="border: 1px solid rgba(59, 130, 246, 0.2);">
                                    <div class="stat-icon"
                                        style="background: rgba(59, 130, 246, 0.1); color: var(--primary);">
                                        <i class="fa-solid fa-download"></i>
                                    </div>
                                    <span class="stat-value" id="speed-download">0 Mbps</span>
                                    <span class="stat-label">Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Download)</span>
                                </div>
                                <div class="stat-card glass" style="border: 1px solid rgba(14, 165, 233, 0.2);">
                                    <div class="stat-icon"
                                        style="background: rgba(14, 165, 233, 0.1); color: var(--secondary);">
                                        <i class="fa-solid fa-upload"></i>
                                    </div>
                                    <span class="stat-value" id="speed-upload">0 Mbps</span>
                                    <span class="stat-label">Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙØ¹ (Upload)</span>
                                </div>
                            </div>

                            <div id="speedtest-loading" style="display: none; padding: 40px; text-align: center;">
                                <i class="fa-solid fa-spinner fa-spin"
                                    style="font-size: 40px; color: var(--primary); margin-bottom: 20px;"></i>
                                <p style="color: var(--text-muted); font-weight: 600;">Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø±Ø¹Ø©... Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚
                                    Ø§Ù„Ø£Ù…Ø± 30-40 Ø«Ø§Ù†ÙŠØ©.</p>
                            </div>
                        </div>

                        <!-- Firestore Free Tier Info -->
                        <div class="card glass"
                            style="margin-top: 24px; background: rgba(245, 158, 11, 0.05); border: 1px solid rgba(245, 158, 11, 0.1);">
                            <div class="card-header">
                                <h4 class="card-title" style="color: #f59e0b;"><i class="fa-solid fa-cloud"
                                        style="margin-left: 8px;"></i>Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© (Google Firestore Free Tier)
                                </h4>
                            </div>
                            <div class="stats-grid"
                                style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); padding: 15px; gap: 12px;">
                                <div class="stat-item"
                                    style="text-align: center; padding: 10px; background: rgba(15, 23, 42, 0.3); border-radius: 8px;">
                                    <span style="display: block; font-size: 18px; font-weight: 800; color: #fff;">{{
                                        cloud_limits.reads_daily }}</span>
                                    <span style="font-size: 11px; color: var(--text-muted);">Ù‚Ø±Ø§Ø¡Ø© Ù…Ø³ØªÙ†Ø¯/ÙŠÙˆÙ…ÙŠØ§Ù‹</span>
                                </div>
                                <div class="stat-item"
                                    style="text-align: center; padding: 10px; background: rgba(15, 23, 42, 0.3); border-radius: 8px;">
                                    <span style="display: block; font-size: 18px; font-weight: 800; color: #fff;">{{
                                        cloud_limits.writes_daily }}</span>
                                    <span style="font-size: 11px; color: var(--text-muted);">ÙƒØªØ§Ø¨Ø© Ù…Ø³ØªÙ†Ø¯/ÙŠÙˆÙ…ÙŠØ§Ù‹</span>
                                </div>
                                <div class="stat-item"
                                    style="text-align: center; padding: 10px; background: rgba(15, 23, 42, 0.3); border-radius: 8px;">
                                    <span style="display: block; font-size: 18px; font-weight: 800; color: #fff;">{{
                                        cloud_limits.deletes_daily }}</span>
                                    <span style="font-size: 11px; color: var(--text-muted);">Ø­Ø°Ù Ù…Ø³ØªÙ†Ø¯/ÙŠÙˆÙ…ÙŠØ§Ù‹</span>
                                </div>
                                <div class="stat-item"
                                    style="text-align: center; padding: 10px; background: rgba(15, 23, 42, 0.3); border-radius: 8px;">
                                    <span style="display: block; font-size: 18px; font-weight: 800; color: #fff;">{{
                                        cloud_limits.storage_free }}</span>
                                    <span style="font-size: 11px; color: var(--text-muted);">Ù…Ø³Ø§Ø­Ø© ØªØ®Ø²ÙŠÙ† Ù…Ø¬Ø§Ù†ÙŠØ©</span>
                                </div>
                            </div>
                            <div
                                style="padding: 0 20px 20px; font-size: 12px; color: var(--text-muted); line-height: 1.6;">
                                <i class="fa-solid fa-circle-info" style="margin-left: 5px; color: #f59e0b;"></i>
                                ØªÙ… ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨ÙˆØª Ù„ÙŠØ¹Ù…Ù„ Ø¨Ø­ÙƒÙ…Ø© Ø¶Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø¯ÙˆØ¯. ØªØ­Ø¯ÙŠØ«Ø§Øª "Ø¢Ø®Ø± Ø¸Ù‡ÙˆØ±" ØªØªÙ… ÙƒÙ„ Ø³Ø§Ø¹Ø© Ù„ØªÙˆÙÙŠØ±
                                Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ¶Ù…Ø§Ù† Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø®Ø¯Ù…Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ùƒ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

    </div>
    </main>
    </div>

    <!-- JavaScript Ø§Ù„Ø£ØµÙ„ÙŠ Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø·ÙÙŠÙØ© Ù„Ù„ØªÙˆØ§ÙÙ‚ -->
    <script>
        function showSection(id, element) {
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙ„
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            const target = document.getElementById(id);
            if (target) target.classList.add('active');

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
            const titles = {
                'overview': 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© / Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª',
                'users': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
                'settings': 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©',
                'channels': 'Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ',
                'errors-section': 'Ø³Ø¬Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªÙ‚Ù†ÙŠØ©',
                'proxies-section': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª',
                'whitelist-section': 'Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ (Ø§Ù„Ù…Ù…ÙŠØ²ÙŠÙ†)',
                'server-specs-section': 'Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø®Ø§Ø¯Ù…'
            };
            document.getElementById('pageTitleDisplay').innerText = titles[id] || 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…';

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            if (element) {
                document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
                element.classList.add('active');
            }
        }

        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        setTimeout(() => {
            const toasts = document.querySelectorAll('.toast');
            toasts.forEach(t => {
                t.style.opacity = '0';
                t.style.transform = 'translateX(-20px)';
                setTimeout(() => t.remove(), 400);
            });
        }, 5000);

        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        document.getElementById('user-search')?.addEventListener('input', function (e) {
            const q = e.target.value.toLowerCase();
            document.querySelectorAll('.user-card-wrapper').forEach(wrapper => {
                const name = wrapper.querySelector('.user-name').innerText.toLowerCase();
                wrapper.style.display = name.includes(q) ? 'block' : 'none';
            });
        });

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        function toggleUserDropdown(event, dropdownId) {
            event.preventDefault();
            event.stopPropagation();

            // Ø¥ØºÙ„Ø§Ù‚ Ø£ÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø£Ø®Ø±Ù‰ Ù…ÙØªÙˆØ­Ø©
            document.querySelectorAll('.dropdown-content').forEach(d => {
                if (d.id !== dropdownId) d.classList.remove('show');
            });

            const dropdown = document.getElementById(dropdownId);
            dropdown.classList.toggle('show');
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø±
        window.addEventListener('click', function () {
            document.querySelectorAll('.dropdown-content').forEach(d => {
                d.classList.remove('show');
            });
        });

        /* â•â•â• ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ (Ù†ÙØ³ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ø§Ø¨Ù‚) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        async function fetchProxies() {
            try {
                const r = await fetch('/proxies/list');
                const d = await r.json();
                renderProxyList(d.proxies);
                document.querySelectorAll('#proxies-count-badge').forEach(b => b.innerText = d.count);
                if (d.count > 0) {
                    document.getElementById('nav-errors').style.color = '';
                }
            } catch (e) { console.error(e); }
        }

        function renderProxyList(list) {
            const container = document.getElementById('proxy-current-list');
            if (!list || list.length === 0) {
                container.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-muted)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
                return;
            }
            container.innerHTML = list.map(p => `
                <div style="padding:6px 10px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center;">
                    <span>${p}</span>
                    <i class="fa-solid fa-check-circle" style="color:var(--success); font-size:12px;"></i>
                </div>
            `).join('');
        }

        async function checkCurrentProxies() {
            const btn = document.getElementById('btn-check-current');
            const oldHtml = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...';

            try {
                const r = await fetch('/proxies/check_current', { method: 'POST' });
                const d = await r.json();
                showProxyResult(`ØªÙ… ÙØ­Øµ Ø§Ù„ÙƒÙ„. Ø§Ù„Ø´ØºØ§Ù„: ${d.working}, Ø§Ù„Ù…ÙŠØª: ${d.dead}`, d.ok);
                fetchProxies();
            } finally {
                btn.disabled = false;
                btn.innerHTML = oldHtml;
            }
        }

        async function addAndCheckProxies() {
            const input = document.getElementById('new-proxies-input').value.trim();
            if (!input) return alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØµØ§Ù‚ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹');

            const btn = document.getElementById('btn-add-check');
            const oldHtml = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª...';

            const formData = new FormData();
            formData.append('new_proxies', input);

            try {
                const r = await fetch('/proxies/add_and_check', { method: 'POST', body: formData });
                const d = await r.json();
                showProxyResult(`ÙØ­ØµÙ†Ø§ ${d.checked} Ø¨Ø±ÙˆÙƒØ³ÙŠ. Ø£Ø¶ÙÙ†Ø§ ${d.working} Ø¹Ø§Ù…Ù„Ø©. Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¢Ù†: ${d.total_after}`, d.ok);
                document.getElementById('new-proxies-input').value = '';
                fetchProxies();
            } finally {
                btn.disabled = false;
                btn.innerHTML = oldHtml;
            }
        }

        async function clearAllProxies() {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠØ§ØªØŸ')) return;
            await fetch('/proxies/clear', { method: 'POST' });
            fetchProxies();
            showProxyResult('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­', true);
        }

        function showProxyResult(msg, success) {
            const box = document.getElementById('proxy-result-box');
            box.innerHTML = `<div class="toast ${success ? 'success' : 'error'}" style="position:static; width:100%; margin-bottom:0;">
                <i class="fa-solid fa-info-circle"></i> ${msg}
            </div>`;
        }

        async function saveConnectionSettings(event) {
            event.preventDefault();
            const token = document.getElementById('field_telegram_token').value.trim();
            const webhook = document.getElementById('field_webhook_url').value.trim();

            const btn = event.target.querySelector('button');
            const oldHtml = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';

            try {
                const response = await fetch('/api/save_settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        telegram_token: token,
                        webhook_url: webhook
                    })
                });

                const result = await response.json();
                if (result.success) {
                    alert('âœ… ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­! Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨ØªØºÙŠÙŠØ± Ø§Ù„ØªÙˆÙƒÙ†ØŒ ÙÙ‚Ø¯ ØªØ­ØªØ§Ø¬ Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ± Ù„ØªÙØ¹ÙŠÙ„Ù‡.');
                } else {
                    alert('âŒ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸: ' + result.error);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ØªÙ‚Ù†ÙŠ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„.');
            } finally {
                btn.disabled = false;
                btn.innerHTML = oldHtml;
            }
        }

        async function activateWebhook(event) {
            const btn = event.currentTarget;
            const oldHtml = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙØ¹ÙŠÙ„...';

            try {
                const response = await fetch('/api/activate_webhook', { method: 'POST' });
                const result = await response.json();

                if (result.success) {
                    alert('âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆÙŠØ¨-Ù‡ÙˆÙƒ Ø¨Ù†Ø¬Ø§Ø­!\n\nØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø¯:\n' + JSON.stringify(result.data, null, 2));
                } else {
                    alert('âŒ ÙØ´Ù„ Ø§Ù„ØªÙØ¹ÙŠÙ„:\n' + (result.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'));
                }
            } catch (err) {
                console.error(err);
                alert('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±');
            } finally {
                btn.disabled = false;
                btn.innerHTML = oldHtml;
            }
        }

        async function fetchServerSpecs() {
            try {
                const r = await fetch('/api/server_specs');
                const d = await r.json();
                document.getElementById('spec-ram').innerText = d.ram;
                document.getElementById('spec-storage').innerText = d.storage;
            } catch (e) {
                console.error("Error fetching specs:", e);
            }
        }

        async function runSpeedTest() {
            const btn = document.getElementById('btn-speedtest');
            const resultsBox = document.getElementById('speedtest-results');
            const loadingBox = document.getElementById('speedtest-loading');

            btn.disabled = true;
            resultsBox.style.display = 'none';
            loadingBox.style.display = 'block';

            try {
                const r = await fetch('/api/speed_test', { method: 'POST' });
                const d = await r.json();

                document.getElementById('speed-download').innerText = d.download;
                document.getElementById('speed-upload').innerText = d.upload;

                loadingBox.style.display = 'none';
                resultsBox.style.display = 'grid';
            } catch (e) {
                console.error("Error running speed test:", e);
                alert("ÙØ´Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø±Ø¹Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.");
                loadingBox.style.display = 'none';
            } finally {
                btn.disabled = false;
            }
        }

        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.addEventListener('load', () => {
            fetchProxies();
            fetchServerSpecs();
        });
    </script>
</body>

</html>